// Rating Plugin by Chris Richards
// Last Update: 6/21/2011
(function(a){a.fn.rating=function(c){var d={showCancel:true,cancelValue:null,cancelTitle:"Cancel",startValue:null,disabled:false};var b={hoverOver:function(e){var f=a(e.target);if(f.hasClass("ui-rating-cancel")){f.addClass("ui-rating-cancel-full")}else{f.prevAll().andSelf().not(".ui-rating-cancel").addClass("ui-rating-hover")}},hoverOut:function(e){var f=a(e.target);if(f.hasClass("ui-rating-cancel")){f.addClass("ui-rating-cancel-empty").removeClass("ui-rating-cancel-full")}else{f.prevAll().andSelf().not(".ui-rating-cancel").removeClass("ui-rating-hover")}},click:function(e){var g=a(e.target);var f=d.cancelValue;g.parents(".content-box-content:first").removeClass("formerror");if(g.hasClass("ui-rating-cancel")){b.empty(g,g.parent())}else{g.closest(".ui-rating-star").prevAll().andSelf().not(".ui-rating-cancel").prop("className","ui-rating-star ui-rating-full");g.closest(".ui-rating-star").nextAll().not(".ui-rating-cancel").prop("className","ui-rating-star ui-rating-empty");g.siblings(".ui-rating-cancel").prop("className","ui-rating-cancel ui-rating-cancel-empty");f=g.attr("value")}if(!e.data.hasChanged){a(e.data.selectBox).val(f).trigger("change")}},change:function(e){var f=a(this).val();b.setValue(f,e.data.container,e.data.selectBox)},setValue:function(g,f,h){var e={target:null,data:{}};e.target=a(".ui-rating-star[id="+h.attr("id")+"_"+g+"]",f);e.data.selectBox=h;e.data.hasChanged=true;b.click(e)},empty:function(f,e){e.find(".ui-rating-star").removeClass("ui-rating-full");e.find(".ui-rating-star").addClass("ui-rating-empty");f.prop("className","ui-rating-cancel ui-rating-cancel-empty").nextAll().prop("className","ui-rating-star ui-rating-empty")}};return this.each(function(){var e=a(this),g,f;if("select-one"!==this.type){return}if(e.prop("hasProcessed")){return}if(c){a.extend(d,c)}e.hide();e.prop("hasProcessed",true);g=a("<div/>").prop({className:"ui-rating"}).insertAfter(e);a("option",e).each(function(){if(this.value!=""){a("<a/>").prop({className:"ui-rating-star ui-rating-empty",title:a(this).text(),id:e.attr("id")+"_"+this.value}).appendTo(g)}});if(true==d.showCancel){a("<a/>").prop({className:"ui-rating-cancel ui-rating-cancel-empty",title:d.cancelTitle}).appendTo(g)}if(0!==a("option:selected",e).size()){b.setValue(e.val(),g,e)}else{f=null!==d.startValue?d.startValue:d.cancelValue;b.setValue(f,g,e);e.val(f)}if(true!==d.disabled&&e.prop("disabled")!==true){a(g).bind("mouseover",b.hoverOver).bind("mouseout",b.hoverOut).bind("click",{selectBox:e},b.click)}e.bind("change",{selectBox:e,container:g},b.change)})}})(jQuery);